<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GigSwipe | Next Gen Job Matching</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #FF4B7D;
            --primary-gradient: linear-gradient(135deg, #FF4B7D, #FF8E53);
            --bg-color: #F0F2F5;
            --glass-bg: rgba(255, 255, 255, 0.8);
            --glass-border: rgba(255, 255, 255, 0.4);
            --card-shadow: 0 15px 35px rgba(0,0,0,0.1);
            --text-main: #333;
            --text-sub: #666;
            --btn-reject: #FF4B4B;
            --btn-like: #4ECC94;
            --btn-rewind: #FFBA00;
        }

        body.mode-boss {
            --primary-color: #4B79FF;
            --primary-gradient: linear-gradient(135deg, #4B79FF, #00C6FF);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; -webkit-tap-highlight-color: transparent; }
        
        body {
            font-family: 'Poppins', 'Noto Sans TC', sans-serif;
            background-color: #1a1a1a;
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; overflow: hidden;
        }

        #app-frame {
            width: 375px; height: 660px;
            background: var(--bg-color); border-radius: 40px;
            position: relative; overflow: hidden;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }

        /* Splash Screen */
        #splash-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--primary-gradient); z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            color: white; transition: opacity 0.5s ease;
        }
        .logo-pulse { font-size: 80px; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

        /* Header */
        header {
            position: absolute; top: 0; left: 0; width: 100%;
            padding: 20px; display: flex; justify-content: space-between; align-items: center;
            z-index: 100; background: var(--glass-bg); backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--glass-border);
        }

        .toggle-switch {
            background: #e0e0e0; border-radius: 20px; padding: 4px;
            display: flex; cursor: pointer; position: relative; width: 100px; height: 36px;
            box-shadow: inset 2px 2px 5px rgba(0,0,0,0.1);
        }
        .toggle-indicator {
            position: absolute; top: 4px; left: 4px; width: 46px; height: 28px;
            background: white; border-radius: 16px; transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        body.mode-boss .toggle-indicator { transform: translateX(46px); }
        .toggle-labels { width: 100%; display: flex; position: relative; z-index: 2; font-size: 12px; font-weight: bold; line-height: 28px; color: #888; }
        .toggle-labels span { width: 50%; text-align: center; }
        .active-label { color: var(--primary-color); }

        /* Card System */
        #card-container { position: relative; width: 100%; height: 100%; padding-top: 80px; display: flex; justify-content: center; }
        .card {
            position: absolute; width: 335px; height: 470px;
            background: white; border-radius: 30px; box-shadow: var(--card-shadow);
            overflow: hidden; cursor: grab; transition: transform 0.1s linear;
        }
        .card img { width: 100%; height: 60%; object-fit: cover; pointer-events: none; }
        .card-info { padding: 15px 20px; height: 40%; display: flex; flex-direction: column; }
        .card-header h2 { font-size: 20px; color: var(--text-main); }
        .meta { display: flex; gap: 10px; margin: 5px 0; font-size: 12px; color: #888; }
        .tags { display: flex; gap: 6px; flex-wrap: wrap; margin-top: 8px; }
        .tag { background: #f0f2f5; color: #666; padding: 4px 10px; border-radius: 10px; font-size: 11px; font-weight: 600; }
        .tag-dist { background: #E3F2FD; color: #2196F3; } /* 距離標籤 */

        /* Badges */
        .status-badge {
            position: absolute; top: 30px; padding: 5px 15px; border: 4px solid; border-radius: 10px;
            font-size: 28px; font-weight: 900; opacity: 0; z-index: 10;
        }
        .badge-like { right: 20px; border-color: var(--btn-like); color: var(--btn-like); transform: rotate(15deg); }
        .badge-nope { left: 20px; border-color: var(--btn-reject); color: var(--btn-reject); transform: rotate(-15deg); }

        /* Controls */
        .controls {
            position: absolute; bottom: 25px; width: 100%;
            display: flex; justify-content: center; align-items: center; gap: 15px; z-index: 100;
        }
        .btn-round {
            width: 55px; height: 55px; border-radius: 50%; background: white;
            box-shadow: 0 8px 15px rgba(0,0,0,0.08); border: none; display: flex;
            justify-content: center; align-items: center; font-size: 20px; cursor: pointer; transition: 0.2s;
        }
        .btn-round:active { transform: scale(0.9); }
        .btn-nope { color: var(--btn-reject); }
        .btn-like { color: var(--btn-like); font-size: 24px; }
        .btn-rewind { color: var(--btn-rewind); width: 40px; height: 40px; font-size: 16px; }

        /* Detail Modal */
        #detail-modal {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 2000; transform: translateY(100%);
            transition: transform 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            display: flex; flex-direction: column;
        }
        #detail-modal.open { transform: translateY(0); }
        .detail-img { width: 100%; height: 40%; object-fit: cover; }
        .detail-body { padding: 30px; overflow-y: auto; flex: 1; }

        /* Match Overlay & Chat (保持先前邏輯) */
        #match-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 3000; display: flex;
            flex-direction: column; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: 0.3s;
        }
        #match-overlay.active { opacity: 1; pointer-events: auto; }
        .match-title { font-size: 40px; color: #4ECC94; font-weight: 900; font-style: italic; margin-bottom: 30px; }

    </style>
</head>
<body>

    <div id="app-frame">
        <div id="splash-screen">
            <i class="fas fa-fire logo-pulse"></i>
            <h1 style="margin-top: 15px; letter-spacing: 2px;">GigSwipe</h1>
        </div>

        <header>
            <i class="fas fa-user-circle" style="font-size: 24px; color: #ccc;"></i>
            <div class="toggle-switch" onclick="toggleMode()">
                <div class="toggle-indicator"></div>
                <div class="toggle-labels">
                    <span id="label-c" class="active-label">找工</span>
                    <span id="label-b">找人</span>
                </div>
            </div>
            <i class="fas fa-comment-dots" style="font-size: 24px; color: #ccc;"></i>
        </header>

        <div id="card-container"></div>

        <div class="controls">
            <button class="btn-round btn-rewind" onclick="rewind()"><i class="fas fa-undo"></i></button>
            <button class="btn-round btn-nope" onclick="forceSwipe('left')"><i class="fas fa-times"></i></button>
            <button class="btn-round btn-like" onclick="forceSwipe('right')"><i class="fas fa-heart"></i></button>
        </div>

        <div id="detail-modal">
            <img id="detail-img" class="detail-img" src="">
            <div class="detail-body">
                <h2 id="detail-name">名稱</h2>
                <p id="detail-title" style="color:var(--primary-color); font-weight:600;"></p>
                <div id="detail-meta" class="meta"></div>
                <hr style="margin:20px 0; opacity:0.1;">
                <p style="line-height:1.6; color:#555;">這是一個針對 Z 世代開發的媒合說明。這裡會顯示工作的詳細內容、公司文化，或是候選人的作品集連結與自我介紹。</p>
                <button class="btn-round" style="width:100%; border-radius:15px; background:var(--primary-gradient); color:white; margin-top:30px;" onclick="closeDetail()">返回滑動</button>
            </div>
        </div>

        <div id="match-overlay">
            <div class="match-title">IT'S A MATCH!</div>
            <img id="match-avatar" src="" style="width:120px; height:120px; border-radius:50%; border:4px solid white; margin-bottom:20px;">
            <p style="color:white; margin-bottom:30px;">雙方都感興趣，立刻開始溝通吧！</p>
            <button class="btn-round" style="width:200px; border-radius:30px; background:white; color:var(--primary-color); font-weight:700;" onclick="closeMatch()">太棒了</button>
        </div>
    </div>

    <script>
        const C_DATA = [
            { id: 'c1', name: 'MAYO 鼎恆數位', title: '臨時專案助理', price: '$200/hr', loc: '竹北', tags: ['#HRTech', '#行政'], isTarget: true, img: 'https://images.unsplash.com/photo-1522071820081-009f0129c71c?w=500' },
            { id: 'c2', name: 'StayReal Café', title: '假日外場', price: '$190/hr', loc: '中山區', tags: ['#現領', '#文青'], isTarget: false, img: 'https://images.unsplash.com/photo-1554118811-1e0d58224f24?w=500' },
            { id: 'c3', name: 'Ogilvy 奧美', title: '設計實習生', price: '$210/hr', loc: '信義區', tags: ['#視覺', '#廣告'], isTarget: false, img: 'https://images.unsplash.com/photo-1542744173-8e7e53415bb0?w=500' }
        ];

        const B_DATA = [
            { id: 'b1', name: '熊小剛', title: '交大資工碩', price: '$250/hr', loc: '新竹', tags: ['#Backend', '#Python'], isTarget: true, img: 'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=500' },
            { id: 'b2', name: 'Jimmy', title: '資深 UI 設計', price: '面議', loc: '台北', tags: ['#Figma', '#設計師'], isTarget: true, img: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=500' }
        ];

        let currentMode = 'c';
        let activeData = [];
        let history = []; // 用於 Rewind
        let currentCardIndex = 0;

        window.onload = () => {
            setTimeout(() => { document.getElementById('splash-screen').style.opacity = '0'; 
            setTimeout(() => document.getElementById('splash-screen').style.display='none', 500); }, 1500);
            renderCards();
        };

        function toggleMode() {
            currentMode = currentMode === 'c' ? 'b' : 'c';
            document.body.className = currentMode === 'b' ? 'mode-boss' : '';
            document.getElementById('label-c').className = currentMode === 'c' ? 'active-label' : '';
            document.getElementById('label-b').className = currentMode === 'b' ? 'active-label' : '';
            renderCards();
        }

        function renderCards() {
            const container = document.getElementById('card-container');
            container.innerHTML = '';
            activeData = currentMode === 'c' ? [...C_DATA] : [...B_DATA];
            
            activeData.forEach((d, i) => {
                const card = createCard(d, i);
                container.appendChild(card);
            });
            setupTopCard();
        }

        function createCard(data, index) {
            const el = document.createElement('div');
            el.className = 'card';
            el.style.zIndex = index;
            // 隨機生成 1km 內的即時距離
            const dist = (Math.random() * 0.9 + 0.1).toFixed(1);
            
            el.innerHTML = `
                <div class="status-badge badge-like">LIKE</div>
                <div class="status-badge badge-nope">NOPE</div>
                <img src="${data.img}">
                <div class="card-info">
                    <div class="card-header">
                        <h2>${data.name}</h2>
                        <p style="color:var(--primary-color); font-size:14px; font-weight:600;">${data.title}</p>
                    </div>
                    <div class="meta">
                        <span><i class="fas fa-map-marker-alt"></i> ${data.loc}</span>
                        <span><i class="fas fa-coins"></i> ${data.price}</span>
                    </div>
                    <div class="tags">
                        <span class="tag tag-dist"><i class="fas fa-location-arrow"></i> 距離 ${dist} km</span>
                        ${data.tags.map(t => `<span class="tag">${t}</span>`).join('')}
                    </div>
                </div>
            `;
            
            el.onclick = (e) => { if(el.dataset.dragging !== 'true') openDetail(data, dist); };
            return el;
        }

        function setupTopCard() {
            const cards = document.querySelectorAll('.card');
            if (cards.length === 0) return;
            const topCard = cards[cards.length - 1];
            currentCardIndex = cards.length - 1;
            applySwipe(topCard);
        }

        function applySwipe(card) {
            let startX = 0, currentX = 0, isDragging = false;
            const likeBadge = card.querySelector('.badge-like');
            const nopeBadge = card.querySelector('.badge-nope');

            const start = (e) => {
                isDragging = true;
                card.dataset.dragging = 'false';
                startX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                card.style.transition = 'none';
            };

            const move = (e) => {
                if (!isDragging) return;
                currentX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                const deltaX = currentX - startX;
                if(Math.abs(deltaX) > 5) card.dataset.dragging = 'true';
                
                const rotate = deltaX * 0.05;
                card.style.transform = `translateX(${deltaX}px) rotate(${rotate}deg)`;
                
                const opacity = Math.min(Math.abs(deltaX) / 100, 1);
                if (deltaX > 0) { likeBadge.style.opacity = opacity; nopeBadge.style.opacity = 0; }
                else { nopeBadge.style.opacity = opacity; likeBadge.style.opacity = 0; }
            };

            const end = () => {
                if (!isDragging) return;
                isDragging = false;
                const deltaX = currentX - startX;
                if (Math.abs(deltaX) > 100) {
                    const dir = deltaX > 0 ? 1 : -1;
                    completeSwipe(card, dir);
                } else {
                    card.style.transition = '0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
                    card.style.transform = 'translateX(0) rotate(0)';
                    likeBadge.style.opacity = 0; nopeBadge.style.opacity = 0;
                }
            };

            card.addEventListener('mousedown', start);
            window.addEventListener('mousemove', move);
            window.addEventListener('mouseup', end);
            card.addEventListener('touchstart', start);
            card.addEventListener('touchmove', move);
            card.addEventListener('touchend', end);
        }

        function completeSwipe(card, dir) {
            card.style.transition = '0.5s ease-in';
            card.style.transform = `translateX(${dir * 500}px) rotate(${dir * 30}deg)`;
            history.push(card); // 存入歷史紀錄
            setTimeout(() => {
                card.style.display = 'none';
                if (dir === 1 && card.querySelector('h2').innerText.includes('MAYO') || card.querySelector('h2').innerText.includes('熊小剛')) {
                    triggerMatch(card);
                }
                setupTopCard();
            }, 300);
        }

        function forceSwipe(direction) {
            const cards = document.querySelectorAll('.card');
            const topCard = cards[currentCardIndex];
            if (topCard) completeSwipe(topCard, direction === 'right' ? 1 : -1);
        }

        function rewind() {
            if (history.length === 0) return;
            const lastCard = history.pop();
            lastCard.style.display = 'block';
            lastCard.style.transition = 'none';
            lastCard.style.transform = 'translateX(0) rotate(0)';
            lastCard.querySelector('.badge-like').style.opacity = 0;
            lastCard.querySelector('.badge-nope').style.opacity = 0;
            setTimeout(() => {
                lastCard.style.transition = '0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
                setupTopCard();
            }, 10);
        }

        function openDetail(data, dist) {
            const modal = document.getElementById('detail-modal');
            document.getElementById('detail-img').src = data.img;
            document.getElementById('detail-name').innerText = data.name;
            document.getElementById('detail-title').innerText = data.title;
            document.getElementById('detail-meta').innerHTML = `<span><i class="fas fa-location-arrow"></i> 距離 ${dist} km</span> <span><i class="fas fa-coins"></i> ${data.price}</span>`;
            modal.classList.add('open');
        }

        function closeDetail() { document.getElementById('detail-modal').classList.remove('open'); }
        function triggerMatch(card) {
            document.getElementById('match-avatar').src = card.querySelector('img').src;
            document.getElementById('match-overlay').classList.add('active');
        }
        function closeMatch() { document.getElementById('match-overlay').classList.remove('active'); }
    </script>
</body>
</html>